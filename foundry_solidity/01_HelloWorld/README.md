# Hello World工程
1. 初始化工程

使用forge来初始化项目，这里使用[soldeer]来做项目的依赖管理。
```sh
forge init
forge soldeer init
rm -rf lib
```

    foundry一开始是使用git的submodule来做依赖管理的。随着越来越多的本地依赖的需求产生，使用git submodule的方式并不能很方便与很好的满足，所以迁移到了[soldeer]的依赖管理方式。[soldeer]是一款用rust开发的solidity依赖管理工具，类似我们熟知的npm, cargo，它也有一个在线的包管理查询中心[soldeer.xyz](soldeer.xyz)

执行完上述初始化命令后，将会得到如下的目录结构
```sh
.
├── README.md
├── dependencies
│   └── forge-std-1.9.7
├── foundry.toml
├── remappings.txt
├── script
│   └── Counter.s.sol
├── soldeer.lock
├── src
│   └── Counter.sol
└── test
    └── Counter.t.sol
```

2. 修改代码

参考工程目录的代码，进行相关修改，这里可以先不要太在意语法，先照着修改与执行，体验一下整体过程。
也可以直接clone代码库。

3. 测试代码

执行测试指令, 注意，这里执行的测试是单元测试，并不会与链进行交互。
```sh
forge test

# 将会看到如下输出
[⠊] Compiling...
No files changed, compilation skipped

Ran 1 test for test/Hello.t.sol:HelloWorldTest
[PASS] test_sayHello() (gas: 23490)
Suite result: ok. 1 passed; 0 failed; 0 skipped; finished in 5.05ms (1.29ms CPU time)

Ran 1 test suite in 99.96ms (5.05ms CPU time): 1 tests passed, 0 failed, 0 skipped (1 total tests)
```
```

```

4. 链上测试

在上一步中，我们进行了合约的单元测试，当验证合约逻辑没有问题后，我们可以将合约部署到测试链上再次验证。
链上测试可以使用以太坊提供的几条测试链，不过他们都需要一些实际的测试代币，才能用于支付合约运行的gas费用，而测试代币虽然可以从免费的faucet领取，但是大部分领取水龙头要求你的账户在mainnet上需要包含至少0.001eth。这对于部分初学者来说可能比较麻烦。恰好foundry为我们提供了`anvil`工具，它可以在本地运行一个以太坊的测试链, 使用`anvil`可以很方便的进行链上测试。

启动`anvil`，并将其运行在本地的8545端口上。
```sh
anvil
# 将会看到如下输出
                             _   _
                            (_) | |
      __ _   _ __   __   __  _  | |
     / _` | | '_ \  \ \ / / | | | |
    | (_| | | | | |  \ V /  | | | |
     \__,_| |_| |_|   \_/   |_| |_|

    1.2.3-stable (a813a2cee7 2025-06-08T15:42:50.507050000Z)
    https://github.com/foundry-rs/foundry

Available Accounts
==================

(0) 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000.000000000000000000 ETH)
(1) 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 (10000.000000000000000000 ETH)

Private Keys
==================

(0) 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
(1) 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
```

anvil会提供10个测试地址和他们的私钥，每个地址里都有预置的10000ETH，可以方便的用来做链上测试。
接下来，可以很方便的进行链上测试
```sh
forge script script/Hello.s.sol --fork-url http://localhost:8545 --broadcast --interactives 1

# 将会看到如下输出，中间需要你输入一个私钥，可以从上面提到的anvil提供的10个测试账号私钥里任选一个
[⠊] Compiling...
[⠰] Compiling 3 files with Solc 0.8.30
[⠔] Solc 0.8.30 finished in 324.16ms
Compiler run successful!
Enter private key:
Script ran successfully.

## Setting up 1 EVM.

==========================

Chain 31337

Estimated gas price: 2.000000001 gwei

Estimated total gas used for script: 461433

Estimated amount required: 0.000922866000461433 ETH

==========================

##### anvil-hardhat
✅  [Success] Hash: 0xdf144a93a267ac0a7715ae10634cf09ee0db3b76e65e79365bd3805e582af2df
Contract Address: 0x5FbDB2315678afecb367f032d93F642f64180aa3
Block: 1
Paid: 0.000354949000354949 ETH (354949 gas * 1.000000001 gwei)

✅ Sequence #1 on anvil-hardhat | Total Paid: 0.000354949000354949 ETH (354949 gas * avg 1.000000001 gwei)


==========================

ONCHAIN EXECUTION COMPLETE & SUCCESSFUL.

Transactions saved to: /Users/fantasy/Documents/workspace/blockchain/ethereum/foundry_solidity/01_HelloWorld/broadcast/Hello.s.sol/31337/run-latest.json

Sensitive values saved to: /Users/fantasy/Documents/workspace/blockchain/ethereum/foundry_solidity/01_HelloWorld/cache/Hello.s.sol/31337/run-latest.json
```
```
```

可以使用cast查看本次tx, 注意交易hash需要从上文中的`✅  [Success] Hash:`中寻找
```
cast tx 0xdf144a93a267ac0a7715ae10634cf09ee0db3b76e65e79365bd3805e582af2df --rpc-url 127.0.0.1:8545
# 将会看到如下输出
blockHash            0x7f756c1789106a41509815200a8033128644816ded85a31f86a2df12d2b6d3d1
blockNumber          1
from                 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
transactionIndex     0
effectiveGasPrice    1000000001

accessList           []
chainId              31337
gasLimit             461433
hash                 0xdf144a93a267ac0a7715ae10634cf09ee0db3b76e65e79365bd3805e582af2df
input                0x60806040526040518060400160405280601181526020017f48656c6c6f20576f726c64212049276d200000000000000000000000000000008152505f90816100479190610296565b50348015610053575f5ffd5b50610365565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f60028204905060018216806100d457607f821691505b6020821081036100e7576100e6610090565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026101497fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8261010e565b610153868361010e565b95508019841693508086168417925050509392505050565b5f819050919050565b5f819050919050565b5f61019761019261018d8461016b565b610174565b61016b565b9050919050565b5f819050919050565b6101b08361017d565b6101c46101bc8261019e565b84845461011a565b825550505050565b5f5f905090565b6101db6101cc565b6101e68184846101a7565b505050565b5b81811015610209576101fe5f826101d3565b6001810190506101ec565b5050565b601f82111561024e5761021f816100ed565b610228846100ff565b81016020851015610237578190505b61024b610243856100ff565b8301826101eb565b50505b505050565b5f82821c905092915050565b5f61026e5f1984600802610253565b1980831691505092915050565b5f610286838361025f565b9150826002028217905092915050565b61029f82610059565b67ffffffffffffffff8111156102b8576102b7610063565b5b6102c282546100bd565b6102cd82828561020d565b5f60209050601f8311600181146102fe575f84156102ec578287015190505b6102f6858261027b565b86555061035d565b601f19841661030c866100ed565b5f5b828110156103335784890151825560018201915060208501945060208101905061030e565b86831015610350578489015161034c601f89168261025f565b8355505b6001600288020188555050505b505050505050565b6104d2806103725f395ff3fe608060405234801561000f575f5ffd5b5060043610610034575f3560e01c806386b714e214610038578063c3a9b1c514610056575b5f5ffd5b610040610086565b60405161004d91906101ac565b60405180910390f35b610070600480360381019061006b9190610309565b610111565b60405161007d91906101ac565b60405180910390f35b5f80546100929061037d565b80601f01602080910402602001604051908101604052809291908181526020018280546100be9061037d565b80156101095780601f106100e057610100808354040283529160200191610109565b820191905f5260205f20905b8154815290600101906020018083116100ec57829003601f168201915b505050505081565b60605f82604051602001610126929190610479565b6040516020818303038152906040529050919050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f61017e8261013c565b6101888185610146565b9350610198818560208601610156565b6101a181610164565b840191505092915050565b5f6020820190508181035f8301526101c48184610174565b905092915050565b5f604051905090565b5f5ffd5b5f5ffd5b5f5ffd5b5f5ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b61021b82610164565b810181811067ffffffffffffffff8211171561023a576102396101e5565b5b80604052505050565b5f61024c6101cc565b90506102588282610212565b919050565b5f67ffffffffffffffff821115610277576102766101e5565b5b61028082610164565b9050602081019050919050565b828183375f83830152505050565b5f6102ad6102a88461025d565b610243565b9050828152602081018484840111156102c9576102c86101e1565b5b6102d484828561028d565b509392505050565b5f82601f8301126102f0576102ef6101dd565b5b813561030084826020860161029b565b91505092915050565b5f6020828403121561031e5761031d6101d5565b5b5f82013567ffffffffffffffff81111561033b5761033a6101d9565b5b610347848285016102dc565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061039457607f821691505b6020821081036103a7576103a6610350565b5b50919050565b5f81905092915050565b5f819050815f5260205f209050919050565b5f81546103d58161037d565b6103df81866103ad565b9450600182165f81146103f9576001811461040e57610440565b60ff1983168652811515820286019350610440565b610417856103b7565b5f5b8381101561043857815481890152600182019150602081019050610419565b838801955050505b50505092915050565b5f6104538261013c565b61045d81856103ad565b935061046d818560208601610156565b80840191505092915050565b5f61048482856103c9565b91506104908284610449565b9150819050939250505056fea264697066735822122099a226e578a23e5532f3307e6ed531cba3141673999e0ed85fb21fcf41c7527c64736f6c634300081e0033
maxFeePerGas         2000000001
maxPriorityFeePerGas 1
nonce                0
r                    0x4d345f64c6db36709c6d3966ea9bcaf0af6a6299ccaccd2527510a36219b41b7
s                    0x39306b41bd1f4e5730e784d04a94f1ff88c93c0b5805906a92fee51d8290874c
to
type                 2
value                0
yParity              0
```

```
```

至此，我们完成了第一个以太坊智能合约的开发与测试。假设这是一个真实的合约，我们可以将其部署到主网或其他测试网进行实际的使用。






[soldeer]: https://soldeer.xyz/
